
<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Acompanhamento de Carregamento</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script>
  <meta charset="UTF-8">
  <style>
  
    body {
        font-family: 'Inter', sans-serif;
  background-color: #000; /* fundo preto */
  color: #fff; /* texto branco */
  padding: 20px;
  max-width: 600px;
  margin: auto;
}

h1 {
  text-align: center;
  color: #fcf81a; /* pode manter esse verde vibrante */
  font-size: 1.8rem;
  margin-bottom: 20px;
}

form {
  background: #1a1a1a; 
  border-radius: 12px;
  padding: 20px;
  box-shadow: 0 2px 8px rgba(255, 255, 255, 0.05); /* leve sombra branca */
}

label {
  display: block;
  margin-bottom: 12px;
  font-weight: 600;
}

input, select, button {
  width: 100%;
  padding: 10px;
  margin-top: 4px;
  margin-bottom: 16px;
  border-radius: 8px;
  border: 1px solid #555; /* borda mais suave em modo escuro */
  background-color: #111;
  color: #fff;
  font-size: 1rem;
  transition: all 0.2s ease-in-out;
}

input::placeholder,
select::placeholder {
  color: #aaa; /* placeholder mais claro */
}

button {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  background-color: #3b82f6;
  color: white;
  border: none;
  cursor: pointer;
  transition: background-color 0.3s ease;
}

button:hover {
  background-color: #2563eb;
  transform: scale(1.03);
}

.btn-adicionar { background-color: #10b981; }
.btn-adicionar:hover { background-color: #059669; }

.btn-remover { background-color: #ef4444; }
.btn-remover:hover { background-color: #dc2626; }

hr {
  margin: 24px 0;
  border: none;
  border-top: 1px solid #333;
}
    .horarios label,


    .lacres label {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 10px;
  }

  .lacres input[type="text"] {
    min-width: 250px; /* üëà aqui aumentamos o tamanho m√≠nimo */
    padding: 6px;
    font-size: 14px;
  }
  .lacres button {
    padding: 6px 10px;
  }
  .lacres input[type="checkbox"] {
    transform: scale(1); /* deixa o checkbox um pouco maior tamb√©m, se quiser */
  }
  .lacres input[type="text"] {
    flex: 1; /* Para os campos de texto ocuparem espa√ßo proporcional */
  }



  .cargas label {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 10px;
  }

  .cargas input[type="text"] {
    min-width: 250px;
    padding: 6px;
    font-size: 14px;
  }

  .cargas input[type="checkbox"] {
    transform: scale(1); /* deixa mais vis√≠vel, opcional */
  }



    .rotas label {
      font-weight: normal;
    }
    .checkbox-group {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }
    .checkbox-group label {
      background: #3d3d3d;
      border-radius: 8px;
      padding: 8px 12px;
    }
    .cargas label {
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .cargas input[type="number"] {
      width: 60px;
      text-align: center;
    }
    .cargas button {
      width: 36px;
      padding: 6px;
      font-size: 1.2rem;
    }
    #rotasCheckboxes label {
      flex: 1 1 20%;
      min-width: 50px;
      text-align: center;
    }
    .rotas input[type="checkbox"] {
      margin-right: 6px;
    }
  </style>

</head>
<body>
  <h1>Acompanhamento de Carregamento</h1>
  <form id="form-carregamento">
    <label>Data:
      <input type="date" id="data" name="data">
      <button type="button" onclick="inserirData()">Inserir Data</button>
    </label>

    <label for="rota-select">Rota:</label>
    <select id="rota-select">
      <option value="">Selecione uma rota</option>
      <option value="Aragua√≠na">Aragua√≠na</option>
      <option value="Gurupi">Gurupi</option>
      <option value="Guara√≠">Guara√≠</option>
      <option value="Luiz Eduardo Magalh√£es">Luiz Eduardo Magalh√£es</option>
      <option value="Barreiras">Barreiras</option>
    </select>

    <label>Doca:
      <select id="doca" name="doca">
        <option value="01">01</option><option value="02">02</option><option value="03">03</option>
        <option value="04">04</option><option value="05">05</option><option value="06">06</option>
      </select>
    </label>

    <label>Tipo do Ve√≠culo:
      <select id="tipoVeiculo" name="tipoVeiculo" onchange="verificarTipoVeiculo()">
        <option value="Carreta">Carreta</option><option value="Truck">Truck</option>
        <option value="Toco">Toco</option><option value="3/4">3/4</option>
      </select>
    </label>

    <script>
      const placaMap = {
        "MSR - KIA5I83": ["KIA5I83", ""],
        "MSR - DRX8D24 / JAW3D30": ["DRX8D24", "JAW3D30"],
        "MSR - MXB3387 / MLO6F04": ["MXB3387", "MLO6F04"],
        "MSR - RBL4J23 / ONC3I65": ["RBL4J23", "ONC3I65"],
        "MSR - NWE5A88 / ONG5H07": ["NWE5A88", "ONG5H07"],
        "MSR - PRO5B99": ["PRO5B99", ""],
        "RODACOP - TCK5H69 / HDE8J16": ["TCK5H69", "HDE8J16"],
        "RODACOP - FOF5B57 / RUK2H11": ["FOF5B57", "RUK2H11"],
        "RODACOP - FTB1F75 / RUKJ2J60": ["FTB1F75", "RUKJ2J60"],
        "RODACOP - RVB2C09": ["RVB2C09", ""],
        "RODACOP - OQG8012": ["OQG8012", ""],
        "RODACOP - RFR7E89": ["RFR7E89", ""],
        "RODACOP - OLM1I23": ["OLM1I23", ""],
        "RODACOP - QKA6J98": ["QKA6J98", ""],
        "RODACOP - RSE9F12": ["RSE9F12", ""],
        "RODACOP - RIN8H85": ["RIN8H85", ""],
        "RODACOP - RSB4A72": ["RSB4A72", ""],
        "RODACOP - QWD6D03": ["QWD6D03", ""],
        "RODACOP - OMU6A20": ["OMU6A20", ""],
        "RODACOP - OLH2G94": ["OLH2G94", ""]
      };
    
      function onSelectChange(select) {
        const selected = select.value;
        const manual = selected === "manual";
    
        document.getElementById("placaPrimaria").disabled = !manual;
        document.getElementById("placaSecundaria").disabled = !manual;
    
        if (!manual && placaMap[selected]) {
          const [primaria, secundaria] = placaMap[selected];
          document.getElementById("placaPrimaria").value = primaria;
          document.getElementById("placaSecundaria").value = secundaria;
        } else {
          document.getElementById("placaPrimaria").value = "";
          document.getElementById("placaSecundaria").value = "";
        }
      }
    </script>

<hr>
    <label>Selecione a placa do Ve√≠culo:
      <select onchange="onSelectChange(this)">
        <option value="">Selecione...</option>
        <option value="manual">Inserir Manualmente</option>
        <option value="MSR - KIA5I83">MSR - KIA5I83</option>
        <option value="MSR - DRX8D24 / JAW3D30">MSR - DRX8D24 / JAW3D30</option>
        <option value="MSR - MXB3387 / MLO6F04">MSR - MXB3387 (Dc 05) / MLO6F04</option>
        <option value="MSR - RBL4J23 / ONC3I65">MSR - RBL4J23 (Dc 06) / ONC3I65</option>
        <option value="MSR - NWE5A88 / ONG5H07">MSR - NWE5A88 / ONG5H07</option>
        <option value="MSR - PRO5B99">MSR - PRO5B99</option>
        <option value="RODACOP - TCK5H69 / HDE8J16">RODACOP - TCK5H69 / HDE8J16</option>
        <option value="RODACOP - FOF5B57 / RUK2H11">RODACOP - FOF5B57 / RUK2H11</option>
        <option value="RODACOP - FTB1F75 / RUKJ2J60">RODACOP - FTB1F75 / RUKJ2J60</option>
        <option value="RODACOP - RVB2C09">RODACOP - RVB2C09</option>
        <option value="RODACOP - OQG8012">RODACOP - OQG8012</option>
        <option value="RODACOP - RFR7E89">RODACOP - RFR7E89</option>
        <option value="RODACOP - OLM1I23">RODACOP - OLM1I23</option>
        <option value="RODACOP - QKA6J98">RODACOP - QKA6J98</option>
        <option value="RODACOP - RSE9F12">RODACOP - RSE9F12</option>
        <option value="RODACOP - RIN8H85">RODACOP - RIN8H85</option>
        <option value="RODACOP - RSB4A72">RODACOP - RSB4A72</option>
        <option value="RODACOP - QWD6D03">RODACOP - QWD6D03</option>
        <option value="RODACOP - OMU6A20">RODACOP - OMU6A20</option>
        <option value="RODACOP - OLH2G94">RODACOP - OLH2G94</option>
      </select>
    </label>
        
    <label>Placa Ba√∫ (Se Houver):
      <input type="text" id="placaPrimaria" placeholder="Placa Bau" disabled>
    </label>
    
    <label>Placa Ve√≠culo:
      <input type="text" id="placaSecundaria" placeholder="Placa Cavalo" disabled>
    </label>

    <hr>
    <label>Empresa:
      <select id="empresa" onchange="atualizarMotoristas()">
        <option value="">Selecione a empresa</option>
        <option value="MSR">MSR</option>
        <option value="RODACOP">RODACOP</option>
      </select>
    </label>
    
    <label>Motorista:
      <select id="motorista" onchange="preencherDadosMotorista()">
        <option value="">Selecione o motorista</option>
      </select>
    </label>
    
    <label>CPF: <input type="text" id="cpf" readonly></label><br>
    <label>Telefone: <input type="text" id="telefone" readonly></label>
    
    <script>
    const dadosMotoristas = {
      "MSR": {
        "Paulo Roberto": { cpf: "", telefone: "63992164618" },
        "Flacilde Fagundes": { cpf: "010.746.931-67", telefone: "62981881286" },
        "Tallysson Magno dos Santos": { cpf: "", telefone: "63991169026" },
        "Wellington Pereira da Silva": { cpf: "", telefone: "63991279809" },
        "Marcos Vinicius Souza de Moraes": { cpf: "", telefone: "63991087213" },
        "Evaldo de Queiroz": { cpf: "950.351.335-61", telefone: "63992640497" },
        "Ot√°vio C√¢ndido Neto": { cpf: "", telefone: "63991500105" },
        "Welton Ramos": { cpf: "", telefone: "63992731249" }
      },
      "RODACOP": {
        "Idamilton Andrade Silva": { cpf: "023.474.221-62", telefone: "63981211457" },
        "Francis Aniszewski da Silva Gomes": { cpf: "026.385.201-60", telefone: "63981013325" },
        "Savio de Souza Santos": { cpf: "077.250.851-81", telefone: "63992735270" },
        "Alessandro Noleto Gon√ßalves": { cpf: "022.174.181-06", telefone: "61981887661" },
        "Marcos Vinicius Souza de Moraes": { cpf: "077.063.341-20", telefone: "63992976361" },
        "Dalvan dos Santos": { cpf: "042.027.111-22", telefone: "63992363023" },
        "Mateus da Silva Morais": { cpf: "046.498.831-48", telefone: "63992499550" },
        "Divino Alves Guida": { cpf: "027.865.341-35", telefone: "63999456665" },
        "Railan Pereira Coelho dos Santos": { cpf: "066.304.091-40", telefone: "63991223145" },
        "Romario Aleixo Lima": { cpf: "040.701.101-35", telefone: "63992531915" },
        "Raul Monteiro de Sousa": { cpf: "059.668.101-17", telefone: "63991091677" },
        "Caio Vinicius Oliveira da Silva": { cpf: "603.210.033-22", telefone: "63992541607" },
        "Juan de Souza Ribeiro": { cpf: "070.732.651-74", telefone: "63992817191" },
        "Bismael Rodrigues de Sousa Oliveira": { cpf: "050.908.111-80", telefone: "63992446420" },
        "Wesley Gon√ßalves Rodrigues": { cpf: "590.682.721-68", telefone: "63984014369" },
        "Odair Jos√© de Sousa": { cpf: "989.477.611-68", telefone: "63984826152" },
        "Alex Castro Magalh√£es": { cpf: "009.177.391-16", telefone: "63984135048" },
        "Gabriel Lopes Soares": { cpf: "082.629.441-35", telefone: "63981588214" }
      }
    };
    
    function atualizarMotoristas() {
      const empresaSelecionada = document.getElementById("empresa").value;
      const selectMotorista = document.getElementById("motorista");
    
      // Limpar op√ß√µes atuais
      selectMotorista.innerHTML = '<option value="">Selecione o motorista</option>';
    
      if (empresaSelecionada && dadosMotoristas[empresaSelecionada]) {
        const motoristas = Object.keys(dadosMotoristas[empresaSelecionada]);
        motoristas.forEach(nome => {
          const option = document.createElement("option");
          option.value = nome;
          option.textContent = nome;
          selectMotorista.appendChild(option);
        });
      }
    
      // Limpa os campos
      document.getElementById("cpf").value = "";
      document.getElementById("telefone").value = "";
    }
    
    function preencherDadosMotorista() {
      const empresa = document.getElementById("empresa").value;
      const motorista = document.getElementById("motorista").value;
    
      if (empresa && motorista && dadosMotoristas[empresa] && dadosMotoristas[empresa][motorista]) {
        const dados = dadosMotoristas[empresa][motorista];
        document.getElementById("cpf").value = dados.cpf;
        document.getElementById("telefone").value = dados.telefone;
      } else {
        document.getElementById("cpf").value = "";
        document.getElementById("telefone").value = "";
      }
    }
    </script>


    <hr>
    <div class="horarios">
      <label>Chegada Unidade:
        <input type="time" id="horaChegada">
        <button type="button" onclick="registrarHoraComConfirmacao('horaChegada')">Registrar</button>
      </label>
      <label>Hora Doca:
        <input type="time" id="horaDoca">
        <button type="button" onclick="registrarHoraComConfirmacao('horaDoca')">Registrar</button>
      </label>
      <label>In√≠cio Carregamento:
        <input type="time" id="horaInicio">
        <button type="button" onclick="registrarHoraComConfirmacao('horaInicio')">Registrar</button>
      </label>
      <label>T√©rmino Carregamento:
        <input type="time" id="horaTermino">
        <button type="button" onclick="confirmarFotoBauAberto()">Registrar</button>
      </label>
      <label>Sa√≠da:
        <input type="time" id="horaSaida">
        <button type="button" onclick="registrarHoraComConfirmacao('horaSaida')">Registrar</button>
      </label>
      <label>Previs√£o de Destino:
        <input type="text" id="previsaoDestino" placeholder="Digite a previs√£o de destino.">
      </label>
    </div>

    <hr>
    <div class="lacres">
      <label>Lacre Ba√∫
        <input type="text" id="lacreBau">
        <button type="button" onclick="scanQRCode('lacreBau')">Scanear QRCode</button>
      </label>
      <label>Lacre Lateral
        <input type="text" id="lacreLateral1">
        <button type="button" onclick="scanQRCode('lacreLateral1')">Scanear QRCode</button>
        <input type="checkbox" id="lateral1NaoUsa">N√£o utiliza
      </label>
      <label>Lacre Lateral 2
        <input type="text" id="lacreLateral2">
        <button type="button" onclick="scanQRCode('lacreLateral2')">Scanear QRCode</button>
        <input type="checkbox" id="lateral2NaoUsa">N√£o utiliza
      </label>
    </div>

    <hr>
    <div class="cargas">
      <label>Volumoso:
        <button type="button" onclick="alterarContagem('volumoso', -1)">-</button>
        <input type="number" id="volumoso" value="0" min="0">
        <button type="button" onclick="alterarContagem('volumoso', 1)">+</button>
      </label>
      <label>Gaiola:
        <button type="button" onclick="alterarContagem('gaiola', -1)">-</button>
        <input type="number" id="gaiola" value="0" min="0">
        <button type="button" onclick="alterarContagem('gaiola', 1)">+</button>
      </label>
      <label>Manga Pallet:
        <button type="button" onclick="alterarContagem('mangaPallet', -1)">-</button>
        <input type="number" id="mangaPallet" value="0" min="0">
        <button type="button" onclick="alterarContagem('mangaPallet', 1)">+</button>
      </label>
    </div>

    <hr>
    <div class="rotas">
      <label><input type="checkbox" id="valioso"> Valioso</label>
      <label><input type="checkbox" id="car"> Car</label>
      <label><input type="checkbox" id="mot"> Mot</label>
      <div class="rotas-checkboxes">
        <p>Rotas XPT:</p>
        <div id="rotasCheckboxes" class="checkbox-group"></div>
      </div>
    </div>

    <hr>
    <button type="button" onclick="gerarReport()">Gerar Report</button>
  </form>

  <script>
    function inserirData() {
      const hoje = new Date().toISOString().split('T')[0];
      document.querySelectorAll('input[type="date"]').forEach(input => input.value = hoje);
    }

    function verificarTipoVeiculo() {
      const tipo = document.getElementById('tipoVeiculo').value;
      const secLabel = document.getElementById('secundaria-label');
      secLabel.style.display = (tipo === 'carreta') ? 'block' : 'none';
    }

    function preencherDadosMotorista() {
  const empresa = document.getElementById("empresa").value;
  const motorista = document.getElementById("motorista").value;

  const dados = (dadosMotoristas[empresa] && dadosMotoristas[empresa][motorista]) || { cpf: "", telefone: "" };

  document.getElementById("cpf").value = dados.cpf;
  document.getElementById("telefone").value = dados.telefone;

  
  }

    function registrarHoraComConfirmacao(id) {
    const input = document.getElementById(id);
    if (input.value) {
      const confirmar = confirm("Hor√°rio j√° registrado: \"" + input.value + "\". Deseja ajustar?");
      if (!confirmar) return;
    }
    registrarHora(id);
  }

  function registrarHora(id) {
    const agora = new Date();
    const hora = agora.toTimeString().split(":").slice(0, 2).join(":");
    document.getElementById(id).value = hora;
  }

    function confirmarFotoBauAberto() {
      if (confirm("Tirar foto do ba√∫ aberto!")) {
        registrarHora('horaTermino');
      }
    }

    function alterarContagem(id, delta) {
      const input = document.getElementById(id);
      let val = parseInt(input.value);
      if (!isNaN(val)) {
        val += delta;
        if (val < 0) val = 0;
        input.value = val;
      }
    }

    function gerarCheckboxesRotas() {
      const container = document.getElementById('rotasCheckboxes');
      for (let i = 1; i <= 80; i++) {
        const label = document.createElement('label');
        label.innerHTML = `<input type="checkbox" value="${i.toString().padStart(2, '0')}"> ${i.toString().padStart(2, '0')}`;
        container.appendChild(label);
      }
    }

    function gerarReport() {
      if (!confirm("Tem certeza que deseja gerar o relat√≥rio?")) return;

      const dataInput = document.getElementById('data')?.value;
    const data = dataInput ? dataInput.split('-').reverse().join('/') : '';
      const doca = document.getElementById('doca')?.value;
      const rota = document.getElementById('rota-select')?.value;
      const tipoVeiculo = document.getElementById('tipoVeiculo')?.value;
      const placaPrimaria = document.getElementById('placaPrimaria')?.value;
      const placaSecundaria = document.getElementById('placaSecundaria')?.value;
      const motorista = document.getElementById('motorista')?.value;
      const cpf = document.getElementById('cpf')?.value;
      const telefone = document.getElementById('telefone')?.value;
      const horaChegada = document.getElementById('horaChegada')?.value;
      const horaDoca = document.getElementById('horaDoca')?.value;
      const horaInicio = document.getElementById('horaInicio')?.value;
      const horaTermino = document.getElementById('horaTermino')?.value;
      const horaSaida = document.getElementById('horaSaida')?.value;
      const previsaoDestino = document.getElementById('previsaoDestino')?.value;
      const lacreBau = document.getElementById('lacreBau')?.value;
      const lacreLateral1 = document.getElementById('lacreLateral1')?.value || (document.getElementById('lateral1NaoUsa')?.checked ? 'N√£o Utiliza' : '');
      const lacreLateral2 = document.getElementById('lacreLateral2')?.value || (document.getElementById('lateral2NaoUsa')?.checked ? ' ' : '');
      const volumoso = document.getElementById('volumoso')?.value;
      const gaiola = document.getElementById('gaiola')?.value;
      const mangaPallet = document.getElementById('mangaPallet')?.value;
      const rotasSelecionadas = Array.from(document.querySelectorAll('.rotas input[type="checkbox"]:checked'))
  .map(cb => cb.labels[0].innerText)
  .join(', ');

      const mensagem = `Data: ${data}
Doca: ${doca}
${tipoVeiculo}: ${rota}
Placa: ${placaSecundaria}
Placa Cavalo: ${placaPrimaria}
Condutor: ${motorista}
CPF: ${cpf}
Tel: ${telefone}
Chegada na unidade: ${horaChegada}
Encostado na doca: ${horaDoca}
In√≠cio carregamento: ${horaInicio}
T√©rmino: ${horaTermino}
Sa√≠da Liberada: ${horaSaida}
Previs√£o do Destino: ${previsaoDestino}
Gaiolas: ${gaiola}
Rotas: ${rotasSelecionadas}
Lacre Ba√∫: ${lacreBau}
Lacres Laterais: ${lacreLateral1} || ${lacreLateral2}
Manga Pallet com sacolas: ${mangaPallet}
Volumosos: ${volumoso}
Yms sa√≠da ok.   `;

const { jsPDF } = window.jspdf;
const doc = new jsPDF();
doc.setFont("helvetica", "normal");
doc.setFontSize(12);

const margemEsquerda = 10;
const larguraMaxima = 190; 
let y = 10;

const linhas = mensagem.split('\n');

linhas.forEach(linha => {
  const linhasQuebradas = doc.splitTextToSize(linha, larguraMaxima);
    linhasQuebradas.forEach(subLinha => {
    if (y > 280) { 
      doc.addPage();
      y = 10;
    }
    doc.text(subLinha, margemEsquerda, y);
    y += 8;
  });
});

doc.save(`carregamento-${data}.pdf`);
    }

    window.onload = gerarCheckboxesRotas;
  </script>
  <!-- Modal do Scanner QR -->
<div id="qrScannerModal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:#000000aa; justify-content:center; align-items:center; z-index:9999;">
  <div style="background:#fff; padding:20px; border-radius:12px; position:relative;">
    <button onclick="fecharScanner()" style="position:absolute; top:10px; right:10px; background:#ef4444; color:#fff; border:none; padding:4px 8px; border-radius:8px; cursor:pointer;">Fechar</button>
    <div id="qr-reader" style="width: 300px;"></div>
  </div>
</div>
<script>
  let campoAtivo;
  let html5QrCode;

  function scanQRCode(campoId) {
    campoAtivo = document.getElementById(campoId);
    document.getElementById("qrScannerModal").style.display = "flex";

    if (!html5QrCode) {
      html5QrCode = new Html5Qrcode("qr-reader");
    }

    Html5Qrcode.getCameras().then(cameras => {
      console.log("C√¢meras detectadas:", cameras);
      if (cameras && cameras.length) {
        // Tenta encontrar uma c√¢mera traseira (com base no nome)
        let cameraId;
        const backCamera = cameras.find(cam =>
          cam.label.toLowerCase().includes("back") || cam.label.toLowerCase().includes("traseira")
        );

        if (backCamera) {
          cameraId = backCamera.id;
        } else {
          // Se n√£o encontrar, usa a primeira dispon√≠vel
          cameraId = cameras[0].id;
        }

        console.log("ID da c√¢mera selecionada:", cameraId);

        html5QrCode.start(
          cameraId,
          {
            fps: 10,
            qrbox: 250
          },
          (decodedText, decodedResult) => {
            campoAtivo.value = decodedText;
            html5QrCode.stop().then(() => {
              fecharScanner();
            }).catch(err => {
              console.error("Erro ao parar o scanner:", err);
              fecharScanner();
            });
          }
        ).catch(err => {
          alert("Erro ao iniciar a c√¢mera: " + err);
          fecharScanner();
        });
      } else {
        alert("Nenhuma c√¢mera encontrada.");
        fecharScanner();
      }
    }).catch(err => {
      alert("Erro ao acessar c√¢mera: " + err);
      fecharScanner();
    });
  }

  function fecharScanner() {
    document.getElementById("qrScannerModal").style.display = "none";
    if (html5QrCode && html5QrCode._isScanning) {
      html5QrCode.stop().then(() => {
        html5QrCode.clear();
      }).catch(err => {
        console.warn("Erro ao parar scanner:", err);
      });
    } else {
      document.getElementById("qr-reader").innerHTML = "";
    }
  }
</script>


</body>
</html>
